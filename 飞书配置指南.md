# 飞书配置指南 - 降噪项目

本文档包含所有需要在飞书中准备的配置信息。

---

## 📋 第一步: 创建飞书应用

### 1.1 创建应用

1. **访问飞书开放平台**
   - 网址: https://open.feishu.cn/
   - 使用飞书账号登录

2. **创建企业自建应用**
   - 点击"创建企业自建应用"
   - 应用名称: `降噪内容管理`
   - 应用描述: `AI访谈精华策展平台的内容数据源`
   - 应用图标: (可选,上传自定义图标)

3. **获取应用凭证**
   - 创建成功后,进入"凭证与基础信息"
   - **记录以下信息**(后续需要配置到代码中):
     - ✅ **App ID**: `cli_a989e0fcbd7f100c`
     - ✅ **App Secret**: `SNJyt98UL1pmQsbgC9MOJfuVFmu3pZvB`

### 1.2 开通应用权限

1. **进入"权限管理"**
   - 在左侧菜单找到"权限管理"

2. **开通以下权限**
   - 搜索并勾选: `bitable:app:readonly` (读取多维表格)
   - 点击"保存"

3. **发布应用版本**
   - 权限修改后需要发布新版本
   - 进入"版本管理与发布"
   - 点击"创建版本" → "申请发布" → "发布"

---

## 📊 第二步: 创建多维表格

### 2.1 创建新的多维表格

1. **在飞书中打开"多维表格"应用**
   - 飞书工作台 → 多维表格
   - 点击"创建多维表格"

2. **命名表格**
   - 表格名称: `降噪内容库`

### 2.2 创建字段 (共15个字段)

**按照以下顺序创建字段**:

| # | 字段名称 | 字段类型 | 必填 | 配置说明 |
|---|---------|---------|------|---------|
| 1 | **标题** | 单行文本 | ✅ | 访谈标题 |
| 2 | **嘉宾** | 单行文本 | ✅ | 嘉宾姓名 |
| 3 | **来源平台** | 单选 | ✅ | 选项: `小宇宙`、`B站`、`YouTube` |
| 4 | **封面图** | 附件 | ✅ | 上传图片文件 |
| 5 | **标签** | 多选 | ✅ | 预设选项见下方 |
| 6 | **金句1** | 多行文本 | ✅ | 第一条金句 |
| 7 | **金句2** | 多行文本 | ✅ | 第二条金句 |
| 8 | **金句3** | 多行文本 | ✅ | 第三条金句 |
| 9 | **金句4** | 多行文本 | ⭕ | 第四条金句(可选) |
| 10 | **金句5** | 多行文本 | ⭕ | 第五条金句(可选) |
| 11 | **摘要正文** | 多行文本 | ✅ | Markdown格式,约2000字 |
| 12 | **原内容链接** | 超链接 | ✅ | 原访谈URL |
| 13 | **状态** | 单选 | ✅ | 选项: `草稿`、`已发布` |
| 14 | **发布时间** | 日期 | ✅ | 发布日期 |
| 15 | **记录ID** | 自动编号 | ✅ | 飞书自动生成,用作内容唯一标识 |

### 2.3 标签字段详细配置

**字段类型**: 多选

**预设标签选项** (可根据需要添加):
- `大模型`
- `创业`
- `开源`
- `多模态`
- `技术哲学`
- `商业化`
- `AI基础设施`
- `计算机视觉`
- `AGI`
- `产品设计`
- `投资`
- `研究`

> 💡 提示: 可以在创建内容时动态添加新标签

### 2.4 来源平台字段详细配置

**字段类型**: 单选

**选项**:
1. `小宇宙` (播客平台)
2. `B站` (哔哩哔哩视频)
3. `YouTube` (YouTube视频)

### 2.5 状态字段详细配置

**字段类型**: 单选

**选项**:
1. `草稿` (默认选项,前台不显示)
2. `已发布` (前台显示)

> ⚠️ 重要: 只有状态为"已发布"的内容才会在网站上显示

---

## 📝 第三步: 创建测试数据

### 3.1 创建2-3条测试记录

**示例记录1**:

| 字段 | 内容 |
|------|------|
| 标题 | ChatGPT背后的技术哲学 |
| 嘉宾 | Sam Altman |
| 来源平台 | 小宇宙 |
| 封面图 | (上传一张测试图片,建议尺寸1200x800) |
| 标签 | 大模型、创业、技术哲学 |
| 金句1 | AGI不是终点,而是新的起点,真正的挑战在于如何让它造福人类。 |
| 金句2 | 我们需要重新定义"智能"这个词的边界。 |
| 金句3 | 技术乐观主义不等于技术幼稚主义。 |
| 金句4 | (留空) |
| 金句5 | (留空) |
| 摘要正文 | ## 核心观点\n\n在这次深度对话中,Sam分享了他对AGI发展路径的最新思考...\n\n(继续填写Markdown格式的摘要,约2000字) |
| 原内容链接 | https://www.xiaoyuzhoufm.com/episode/123456 |
| 状态 | 已发布 |
| 发布时间 | 2025-10-29 |

**示例记录2**:

| 字段 | 内容 |
|------|------|
| 标题 | 开源AI的商业化困局 |
| 嘉宾 | 李沐 |
| 来源平台 | B站 |
| 封面图 | (上传图片) |
| 标签 | 开源、商业化、AI基础设施 |
| 金句1 | 技术开源容易,生态开源难,这是两个完全不同的维度。 |
| 金句2 | 开源不是免费劳动,而是一种商业策略。 |
| 金句3 | 真正的开源精神在于降低技术门槛,让更多人能够参与创新。 |
| 摘要正文 | ## 访谈背景\n\n李沐分享了他在开源AI领域的深度观察...\n\n(Markdown格式) |
| 原内容链接 | https://www.bilibili.com/video/BV123456 |
| 状态 | 已发布 |
| 发布时间 | 2025-10-28 |

---

## 🔑 第四步: 获取配置ID

### 4.1 获取 Base ID 和 Table ID

1. **打开你创建的多维表格**
   - 在浏览器中打开"降噪内容库"

2. **从URL中提取ID**

浏览器地址栏示例:
```
https://example.feishu.cn/base/bascnXXXXXXXXXXXXXX?table=tblXXXXXXXXXXXXXX&view=vewXXXXXX
```

- ✅ **Base ID**: `FD0uwEbNTiWpgBkOSc1cxBslnQc` (base/后面的部分)
- ✅ **Table ID**: `tblOJWanaihU2lvu` (table=后面的部分)

### 4.2 汇总所有配置信息

**请将以下信息保存到安全的地方**:

```
飞书应用配置:
├─ App ID: cli_xxxxxxxxxx
├─ App Secret: xxxxxxxxxxxxxxxx
├─ Base ID: bascnXXXXXXXXXXXXXX
└─ Table ID: tblXXXXXXXXXXXXXX
```

---

## ✅ 第五步: 验证配置

### 5.1 使用Postman测试飞书API

**测试1: 获取Access Token**

```http
POST https://open.feishu.cn/open-api/auth/v3/tenant_access_token/internal
Content-Type: application/json

{
  "app_id": "你的App ID",
  "app_secret": "你的App Secret"
}
```

**期望返回**:
```json
{
  "code": 0,
  "msg": "success",
  "tenant_access_token": "t-xxxxxxxxxxxx",
  "expire": 7200
}
```

**测试2: 读取多维表格数据**

```http
GET https://open.feishu.cn/open-api/bitable/v1/apps/{Base_ID}/tables/{Table_ID}/records
Authorization: Bearer {上一步获取的token}
```

**期望返回**:
```json
{
  "code": 0,
  "msg": "success",
  "data": {
    "items": [
      {
        "record_id": "recXXXXXX",
        "fields": {
          "标题": "ChatGPT背后的技术哲学",
          "嘉宾": "Sam Altman",
          ...
        }
      }
    ]
  }
}
```

### 5.2 验证检查清单

- [ ] 飞书应用已创建
- [ ] 权限 `bitable:app:readonly` 已开通
- [ ] 应用已发布最新版本
- [ ] 多维表格已创建,包含15个字段
- [ ] 标签预设选项已配置
- [ ] 至少创建了2条测试数据
- [ ] 测试数据状态为"已发布"
- [ ] 已记录 App ID、App Secret、Base ID、Table ID
- [ ] Postman测试获取token成功
- [ ] Postman测试读取表格数据成功

---

## 📌 第六步: 配置到代码

**在Next.js项目中创建 `.env.local` 文件**:

```bash
# 飞书应用配置
FEISHU_APP_ID=cli_xxxxxxxxxx
FEISHU_APP_SECRET=xxxxxxxxxxxxxxxx

# 飞书多维表格配置
FEISHU_BASE_ID=bascnXXXXXXXXXXXXXX
FEISHU_TABLE_ID=tblXXXXXXXXXXXXXX

# Next.js配置
NEXT_PUBLIC_SITE_URL=http://localhost:3000

# 可选配置
ENABLE_IMAGE_CACHE=true
ISR_REVALIDATE=3600
```

---

## 🎯 常见问题 (FAQ)

### Q1: 如何修改已有字段?
**A**: 在飞书多维表格中,点击字段名右侧的下拉箭头 → 字段设置 → 修改

### Q2: 可以删除某个字段吗?
**A**: 可以,但请确保该字段不是必填字段,否则会影响网站显示

### Q3: 标签可以后续添加吗?
**A**: 可以!在"标签"字段的设置中随时添加新的选项

### Q4: 封面图的尺寸要求?
**A**: 建议 1200x800px (3:2比例),文件大小 < 2MB,格式支持 JPG/PNG/WebP

### Q5: Markdown正文如何编辑?
**A**: 在飞书多维表格的"摘要正文"字段中,直接粘贴Markdown格式的文本即可

### Q6: 如何隐藏某篇内容?
**A**: 将"状态"字段改为"草稿",网站将不会显示该内容

### Q7: 飞书API有调用限制吗?
**A**: 有,具体限制请参考飞书开放平台文档。建议代码中实现token缓存和请求重试机制。

### Q8: 如何批量导入内容?
**A**: 可以在飞书多维表格中使用"导入"功能,支持Excel/CSV格式

---

## 📚 参考资料

- 飞书开放平台文档: https://open.feishu.cn/document/home/
- 多维表格API文档: https://open.feishu.cn/document/server-docs/docs/bitable-v1/
- 飞书应用权限说明: https://open.feishu.cn/document/ukTMukTMukTM/uQjN3QjL0YzN04CN2cDN

---

**准备完成后,即可开始代码开发!** 🚀

下一步: 参考 PRD.md 中的"开发里程碑 Phase 2",开始搭建 Next.js 项目。
